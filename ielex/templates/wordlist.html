{% extends "base.html" %}

{% load staticfiles %}
{% load lexicon_utils %}
{% load wtforms %}

{% block title %}
  Word list
{% endblock %}

{% block top %}
  {% if not user.is_authenticated %}
    <h1>Meaning list ‘{{ wordlist }}’</h1>
  {% endif %}
{% endblock %}

{% block controls %}
  <li class="navbar-text">
    List:
  </li>
  <li class="navbar-text dropdown"
      title="Select meaning list"
      data-toggle="tooltip"
      data-placement="bottom">
    <button class="btn btn-default dropdown-toggle"
            type="button" id="meaningListSelection"
            data-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="true"
            style="padding: 0px;">
      {{ wordlist.name }}
      <span class="caret"></span>
    </button>
    <ul class="dropdown-menu" aria-labelledby="meaningListSelection"
        style="overflow-y: scroll; height: 23em;">
      {% for m in otherMeaningLists %}
        <li>
          <a href="/wordlist/{{ m.name }}">
            {{ m.name }}
          </a>
        </li>
      {% endfor %}
    </ul>
  </li>
  {% include "snippets/go_to.html" %}
{% endblock %}

{% block content %}
  <div class="row">
    <div class="col-md-8">
      <form action="" method="post">
        {% if user.is_authenticated and user.is_staff %}
          {% csrf_token %}
          <div class="form-group pull-right">
            <a href="." class="btn btn-default">undo</a>
            <input type="submit" value="Save" name="wordlist" class="btn btn-danger">
          </div>
          <h1 class="inline">
            Meaning list ‘{{ wordlist }}’
            <a href="/meanings/add-new/"
               class="btn btn-default btn-xs"
               data-toggle="tooltip" data-placement="bottom"
               title="add meaning">
              <span class="glyphicon glyphicon-plus-sign"></span>
            </a>
          </h1>
        {% endif %}
        <table class="table table-striped viewTableFilter">
          <thead>
            <tr>
              <th></th>
              <th>Meaning</th>
              <th>Show<br>Languages</th>
              <th>Show<br>Cog. Sets</th>
              {% if user.is_authenticated %}
              <th>Edit<br>metadata</th>
              <th>% Cog.<br>coded</th>
              <th data-toggle="tooltip" data-placement="bottom" data-container="body"
                  title="Number of lexemes">Lex.</th>
              <th data-toggle="tooltip" data-placement="bottom" data-container="body"
                  title="Number of Cognate Classes">Cog.</th>
              {% endif %}
            </tr>
            {% if user.is_authenticated %}
              <tr>
              <th></th>
                <th>
                  <input type="text" class="filterInput form-control"
                         data-selector=".meaningGloss input">
                  <div class="btn btn-xs btn-default sortInput"
                       data-selector=".meaningGloss input">
                    <span class="glyphicon glyphicon-sort"></span>
                  </div>
                </th>
                <th colspan="3"></th>
                <th>
                  <div class="btn btn-xs btn-default sortIntText"
                       data-selector=".meaningPercentCoded">
                    <span class="glyphicon glyphicon-sort"></span>
                  </div>
                </th>
                <th>
                  <div class="btn btn-xs btn-default sortIntText"
                       data-selector=".meaningLexCount">
                    <span class="glyphicon glyphicon-sort"></span>
                  </div>
                </th>
                <th>
                  <div class="btn btn-xs btn-default sortIntText"
                       data-selector=".meaningCogCount">
                    <span class="glyphicon glyphicon-sort"></span>
                  </div>
                </th>
              </tr>
            {% endif %}
          </thead>
          <tbody>
            {% for meaning in mltf.meanings %}
              <tr>
                <td>
                  {% if meaning.data.gloss %}
                    <a href="https://github.com/lingdb/IELex2-CognaC/wiki/{{ meaning.data.gloss }}"
                       title="View wiki page." target="_blank">
                      <span class="glyphicon glyphicon-info-sign"></span>
                    </a>
                  {% endif %}
                </td>
                {% if user.is_authenticated and user.is_staff %}
                  {% form_field meaning.meaningId class="hide" %}
                  <td class="meaningGloss">
                    {% form_field meaning.gloss class="form-control" size="4" %}
                  </td>
                {% else %}
                  <td class="meaningGloss">
                    {{ meaning.data.gloss }}
                  </td>
                {% endif %}
                <td>
                  <a href="{% url 'view-meaning-languages' meaning.data.gloss current_language_list %}"
                     title="Edit ‘{{ meaning.data.gloss }}' by language list">
                    <span class="glyphicon glyphicon-edit"></span>
                  </a>
                </td>
                <td>
                  <a href="{% url 'edit-cogclasses' meaning.data.gloss %}"
                     title="Edit cognate classes for ‘{{ meaning.data.gloss }}'">
                    <span class="glyphicon glyphicon-edit"></span>
                  </a>
                </td>
                {% if user.is_authenticated %}
                  <td>
                    <a href="{% url 'edit-meaning' meaning.data.gloss %}"
                       title="Edit ‘{{ meaning.data.gloss }}’ metadata">
                      <span class="glyphicon glyphicon-edit"></span>
                    </a>
                  </td>
                  <td class="meaningPercentCoded">
                    <span class="badge">
                      {{ meaning.data.percent_coded|floatformat:1 }}
                    </span>
                  </td>
                  <td class="meaningLexCount">
                    <span class="badge">
                      {{ meaning.data.lex_count }}
                    </span>
                  </td>
                  <td class="meaningCogCount">
                    <span class="badge">
                      {{ meaning.data.cog_count }}
                    </span>
                  </td>
                {% endif %}
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </form>
    </div>
  </div>
{% endblock %}
{# vim: set ft=htmldjango nowrap shiftwidth=2 expandtab: #}
